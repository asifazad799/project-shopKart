<style>
    .cartCount{
    border-radius: 2px;
    line-height: 30px;
}
.buttonMinus{
    width: 30px;
    border-radius: 2px;
    border: none;
    color: white;
    padding-top: 3px;
    background-color: rgb(3, 3, 156);
}
.swal2-popup {
font-size: 1.6rem;
}


</style>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
<main class="main">
            {{!-- <nav aria-label="breadcrumb" class="breadcrumb-nav border-0 mb-0">
                <div class="container d-flex align-items-center">
                    <ol class="breadcrumb">
                        <li class="breadcrumb-item"><sapn>Home</sapn></li>
                        <li class="breadcrumb-item"><span></span></li>
                        <li class="breadcrumb-item active" aria-current="page">Default</li>
                    </ol>

                    <nav class="product-pager ml-auto" aria-label="Product">
                        <a class="product-pager-link product-pager-prev" href="#" aria-label="Previous" tabindex="-1">
                            <i class="icon-angle-left"></i>
                            <span>Prev</span>
                        </a>

                        <a class="product-pager-link product-pager-next" href="#" aria-label="Next" tabindex="-1">
                            <span>Next</span>
                            <i class="icon-angle-right"></i>
                        </a>
                    </nav><!-- End .pager-nav -->
                </div><!-- End .container -->
            </nav><!-- End .breadcrumb-nav --> --}}

            <div class="page-content">
                <div class="container">
                    {{#each response}}
                    <div class="product-details-top">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="product-gallery product-gallery-vertical">
                                    <div class="row">
                                        <figure class="product-main-image">
                                            <img id="product-zoom" src="/images/product/productvarients/{{this._id}}_1.png" data-zoom-image="/images/product/productvarients/{{this._id}}_1.png" alt="product image">

                                            <a href="#" id="btn-product-gallery" class="btn-product-gallery">
                                                <i class="icon-arrows"></i>
                                            </a>
                                        </figure><!-- End .product-main-image -->

                                        <div id="product-zoom-gallery" class="product-image-gallery">
                                            <a class="product-gallery-item active" href="#" data-image="/images/product/productvarients/{{this._id}}_1.png" data-zoom-image="/images/product/productvarients/{{this._id}}_1.png">
                                                <img src="/images/product/productvarients/{{this._id}}_1.png" alt="product side">
                                            </a>

                                            <a class="product-gallery-item" href="#" data-image="/images/product/productvarients/{{this._id}}_2.png" data-zoom-image="/images/product/productvarients/{{this._id}}_2.png">
                                                <img src="/images/product/productvarients/{{this._id}}_2.png" alt="product cross">
                                            </a>

                                            <a class="product-gallery-item" href="#" data-image="/images/product/productvarients/{{this._id}}_3.png" data-zoom-image="/images/product/productvarients/{{this._id}}_3.png">
                                                <img src="/images/product/productvarients/{{this._id}}_3.png" alt="product with model">
                                            </a>

                                            <a class="product-gallery-item" href="#" data-image="/images/product/productvarients/{{this._id}}_4.png" data-zoom-image="/images/product/productvarients/{{this._id}}_4.png">
                                                <img src="/images/product/productvarients/{{this._id}}_4.png" alt="product back">
                                            </a>
                                        </div><!-- End .product-image-gallery -->
                                    </div><!-- End .row -->
                                </div><!-- End .product-gallery -->
                            </div><!-- End .col-md-6 -->

                            <div class="col-md-6">
                                <div class="product-details">
                                    {{!-- brand --}}
                                    <h1>{{this.product.brand}}</h1>
                                    <h2 class="product-title" style="font-weight: 600;">{{this.product.category}} <span style="font-size: medium;">{{this.product.productName}}</span> </h2><!-- End .product-title -->
                                    <h2 class="product-title" style="font-weight: 600;"></h2>
                                    {{!-- <div class="ratings-container">
                                        <div class="ratings">
                                            <div class="ratings-val" style="width: 80%;"></div><!-- End .ratings-val -->
                                        </div><!-- End .ratings -->
                                        <a class="ratings-text" href="#product-review-link" id="review-link">( 2 Reviews )</a>
                                    </div><!-- End .rating-container --> --}}

                                    {{!-- <div class="product-price">
                                       ₹{{this.mrp}}
                                        
                                    </div><!-- End .product-price --> --}}
                                    {{#if this.oldProPrice}}
                                    <div class="product-price" style="color: blue;">
                                        ₹{{this.mrp}} <s class="ms-3 text-danger" style="text-decoration-thickness: 2px;">₹{{this.oldProPrice}}</s>
                                    </div>
                  
                                    {{else}}
                                    {{#if this.oldCatPrice}}
                                        <div class="product-price" style="color: blue;">
                                            ₹{{this.mrp}}<s class="ms-3 text-danger" style="text-decoration-thickness: 2px;">₹{{this.oldCatPrice}}</s>
                                        </div>
                                        
                                    {{else}}
                                        <div class="product-price" style="color: blue;">
                                            ₹{{this.mrp}}
                                        </div>
                                    {{/if}}
                                    {{/if}}
                                    <p class="text-success">All tax is included</p>

                                    {{!-- <div class="product-content">
                                        <p>Sed egestas, ante et vulputate volutpat, eros pede semper est, vitae luctus metus libero eu augue. Morbi purus libero, faucibus adipiscing. Sed lectus. </p>
                                    </div><!-- End .product-content --> --}}

                                    {{!-- <div class="details-filter-row details-row-size">
                                        <label>Color:</label>

                                        <div class="product-nav product-nav-thumbs">
                                            <a href="#" class="active">
                                                <img src="assets/images/products/single/1-thumb.jpg" alt="product desc">
                                            </a>
                                            <a href="#">
                                                <img src="assets/images/products/single/2-thumb.jpg" alt="product desc">
                                            </a>
                                        </div><!-- End .product-nav -->
                                    </div><!-- End .details-filter-row --> --}}
                                    {{!-- color selection --}}
                                    {{!-- <div class=" details-row-size mt-2 Pcolors">
                                        <h6>Colors</h6>
                                         <label class="label_colorselector1" style="background-color: blue;" for="colorselector1">
                                             <input class="colorselector1" id="colorselector1" name="colorselector" hidden type="radio" value="blue">
                                        </label>
                                        <label class="label_colorselector2" style="background-color: green;" for="colorselector2"  >
                                             <input class="colorselector2" id="colorselector2" name="colorselector" hidden type="radio" value="green">
                                        </label>
                                        <label class="label_colorselector3" style="background-color: yellow;" for="colorselector3">
                                             <input class="colorselector3" id="colorselector3" name="colorselector" hidden type="radio" value="yellow">
                                        </label>
                                    </div> --}}
                                    {{!-- end of color selection --}}
                                    {{!-- size selection --}}
                                    <div class=" details-row-size mt-2 Psizes">
                                        <h6>Sizes</h6>
                                         <label class="label_sizeselector1 text-center"  for="sizeselector1">
                                             <input class="sizeselector1" id="sizeselector1" name="sizeselector" hidden type="radio" value="small">
                                             <span class="fs-1 sizes">{{this.size}}</span>
                                        </label>
                                        {{!-- <label class="label_colorselector2 text-center"  for="sizeselector2">
                                            
                                            <input class="sizeselector2" id="sizeselector2" name="sizeselector" hidden type="radio" value="medium">
                                            <span class="fs-1 sizes">M</span>
                                        </label>
                                        <label class="label_sizeselector3 text-center"  for="sizeselector3">
                                             <input class="sizeselector3" id="colorselector3" name="sizeselector" hidden type="radio" value="larg">
                                             <span class="fs-1 sizes">L</span>
                                        </label> --}}
                                    </div>
                                    
                                    {{!-- end of size selection --}}
                                    {{!-- <div class="details-filter-row details-row-size">
                                        <label for="size">Size:</label>
                                        <div class="select-custom">
                                            <select name="size" id="size" class="form-control">
                                                <option value="#" selected="selected">Select a size</option>
                                                <option value="s">Small</option>
                                                <option value="m">Medium</option>
                                                <option value="l">Large</option>
                                                <option value="xl">Extra Large</option>
                                            </select>
                                        </div><!-- End .select-custom -->

                                        <a href="#" class="size-guide"><i class="icon-th-list"></i>size guide</a>
                                    </div><!-- End .details-filter-row --> --}}

                                    {{!-- <div class="details-filter-row details-row-size mt-3 mb-3">
                                        <label for="qty"> <h6 class="pt-1">Qty</h6></label>
                                        <div class="product-details-quantity" >
                                            <input type="number" id="qty" class="Pquatity"  value="1" min="1" max="10" step="1" data-decimals="0" required>
                                        </div><!-- End .product-details-quantity -->
                                    </div><!-- End .details-filter-row --> --}}
                                     {{!-- <div class="cart-product-quantity ms-0 pt-3" style="margin-top:-14px"> --}}
                                       
                                        {{!-- <input type="number" class="cartCount" style="border-radius: 2px !important ; height:200px; padding:5px !important;"  value="{{this.quantity}}" min="0" max="10" step="1" data-decimals="0" required> --}}
                                        
                                    {{!-- </div> --}}


                                    <div class="product-details-action">
                                        <div class="row">
                                            {{#if ../currentUser}}
                                            <a onclick="addToCart('{{this._id}}','{{this.mrp}}')" class="cartButton text-center ms-3" style="color: white; cursor: pointer; marigin"><span style="margin-top: 545px; font-weight: 500;">Add to cart</span></a>
                                              <!-- Button trigger modal -->
                                            <a  class="cartButton text-center ms-3" data-toggle="modal" data-target="#exampleModalCenter" style="color: white; cursor: pointer;"><span style="font-weight: 500;">Buy</span></a>
                                            <a  class="cartButton text-center ms-3" style="padding: 0px; width: 47px !important;"> <i class="icon-heart-o wishlistIcon" style="font-size: 24px; color:white"></i></a>
                                            
                                            {{else}}
                                            <a href="/userLogin" class="cartButton text-center ms-3"><span style="font-weight: 500;">Add to cart</span></a>
                                            <a  onclick="pleaseLogin()" class="cartButton text-center ms-3" style="color: white; cursor: pointer;"><span style="font-weight: 500;">Buy</span></a>
                                            <a  onclick="pleaseLogin()" class="cartButton text-center ms-3" style="padding: 0px; width: 47px !important;"> <i class="icon-heart-o wishlistIcon" style="font-size: 24px; color:white"></i></a>

                                            {{/if}}
                                        </div>

                                                                          
                                   
    
                                    <!-- Modal -->
                                    <div class="modal fade" id="exampleModalCenter" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
                                    <div class="modal-dialog modal-dialog-centered" role="document">
                                        <div class="modal-content">
                                        <div class="p-5">
                                        <div class="text-center" >

                                            <h5 class="modal-title" id="exampleModalCenterTitle">Select quantity</h5>
                                           
                                        </div>
                                             
                                            <div class=" details-row-size mt-2 Psizes text-center">
                                                <label class="label_sizeselector1 text-center"  for="qty1">
                                                    <input onclick="buyButton('1')" class="sizeselector1" id="qty1" name="sizeselector" hidden type="radio" value="1">
                                                    <span class="fs-1 sizes">1</span>
                                                </label>
                                                 <label class="label_sizeselector1 text-center"  for="qty2">
                                                    <input onclick="buyButton('2')" class="sizeselector1" id="qty2" name="sizeselector" hidden type="radio" value="2">
                                                    <span class="fs-1 sizes">2</span>
                                                </label>
                                                <label class="label_sizeselector1 text-center"  for="qty3">
                                                    <input onclick="buyButton('3')" class="sizeselector1" id="qty3" name="sizeselector" hidden type="radio" value="3">
                                                    <span class="fs-1 sizes">3</span>
                                                </label>
                                                 <label class="label_sizeselector1 text-center"  for="qty4">
                                                    <input onclick="buyButton('4')" class="sizeselector1" id="qty4" name="sizeselector" hidden type="radio" value="4">
                                                    <span class="fs-1 sizes">4</span>
                                                </label>
                                                <label class="label_sizeselector1 text-center"  for="qty5">
                                                    <input onclick="buyButton('5')" class="sizeselector1" id="qty5" name="sizeselector" hidden type="radio" value="5">
                                                    <span class="fs-1 sizes">5</span>
                                                </label>
                                                
                                            </div>
                                            <div class=" details-row-size mt-2 Psizes text-center">
                                                <label class="label_sizeselector1 text-center"  for="qty6">
                                                    <input onclick="buyButton('6')" class="sizeselector1" id="qty6" name="sizeselector" hidden type="radio" value="6">
                                                    <span class="fs-1 sizes">6</span>
                                                </label>
                                                 <label class="label_sizeselector1 text-center"  for="qty7">
                                                    <input onclick="buyButton('7')" class="sizeselector1" id="qty7" name="sizeselector" hidden type="radio" value="7">
                                                    <span class="fs-1 sizes">7</span>
                                                </label>
                                                <label class="label_sizeselector1 text-center"  for="qty8">
                                                    <input onclick="buyButton('8')" class="sizeselector1" id="qty8" name="sizeselector" hidden type="radio" value="8">
                                                    <span class="fs-1 sizes">8</span>
                                                </label>
                                                 <label class="label_sizeselector1 text-center"  for="qty9">
                                                    <input onclick="buyButton('9')" class="sizeselector1" id="qty9" name="sizeselector" hidden type="radio" value="9">
                                                    <span class="fs-1 sizes">9</span>
                                                </label>
                                                <label class="label_sizeselector1 text-center"  for="qty10">
                                                    <input onclick="buyButton('10')" class="sizeselector1" id="qty10" name="sizeselector" hidden type="radio" value="10">
                                                    <span class="fs-1 sizes">10</span>
                                                </label>
                                               
                                            </div>

                                            <div class=" details-row-size mt-2 Psizes text-center">
                                                <h5 class="modal-title mb-3" id="exampleModalCenterTitle ">Select Delivery</h5>
                                            <div style="display: flex;padding-left: 170px; padding-right: 170px; justify-content: space-around;">

                                                <div>

                                                    <h6>Normal</h6> 
                                                    <p>₹0</p>
                                                    <label class="label_sizeselector1 text-center "  for="normalDel">
                                                        <input onclick="delButton('normal')" class="sizeselector1" id="normalDel" name="delivery" hidden type="radio" value="normal">
                                                        <span class="fs-1 sizes">N</span>
                                                    </label>
                                                </div>
                                                <div>
                                                    <h6>Express</h6> 
                                                    <p>₹40</p>
                                                    <label class="label_sizeselector1 text-center"  for="expressDel">
                                                        <input onclick="delButton('express')" class="sizeselector1" id="expressDel" name="delivery" hidden type="radio" value="express">
                                                        <span class="fs-1 sizes">E</span>
                                                    </label>
                                                </div>
                                            </div>

                                            </div> 
                                           
                                        <div class="text-center" >
                                            <button type="button" class="btn  cartButton text-center ms-3" data-dismiss="modal">Close</button>
                                            <button onclick="buy('{{this._id}}')" type="button" class="btn cartButton text-center ms-3">Buy</button>
                                        </div>
                                        </div>
                                        </div>
                                    </div>
                                    </div>
                                        

                                        {{!-- <div class="details-action-wrapper">
                                            <a href="#" class="btn-product btn-wishlist" title="Wishlist"></a> --}}
                                            {{!-- <a href="#" class="btn-product btn-compare" title="Compare"><span>Add to Compare</span></a> --}}
                                        {{!-- </div> --}}
                                        <!-- End .details-action-wrapper -->
                                    </div><!-- End .product-details-action -->

                                    <div class="product-details-footer">
                                        {{!-- <div class="product-cat">
                                            <span>Category:</span>
                                            <a href="#">Women</a>,
                                            <a href="#">Dresses</a>,
                                            <a href="#">Yellow</a>
                                        </div><!-- End .product-cat --> --}}
                                    {{!-- product info section --}}
                                    <div class="tab-pane fade show active" id="product-desc-tab" role="tabpanel" aria-labelledby="product-desc-link">
                                        <div class="product-desc-content">
                                            <h3>Product Information</h3>
                                            <p>{{this.product.discription}}</p>
                                            <ul>
                                                <li>Nunc nec porttitor turpis. In eu risus enim. In vitae mollis elit. </li>
                                                <li>Vivamus finibus vel mauris ut vehicula.</li>
                                                <li>Nullam a magna porttitor, dictum risus nec, faucibus sapien.</li>
                                            </ul>

                                            <p>Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Donec odio. Quisque volutpat mattis eros. Nullam malesuada erat ut turpis. Suspendisse urna viverra non, semper suscipit, posuere a, pede. Donec nec justo eget felis facilisis fermentum. Aliquam porttitor mauris sit amet orci. Aenean dignissim pellentesque felis. Phasellus ultrices nulla quis nibh. Quisque a lectus. Donec consectetuer ligula vulputate sem tristique cursus. </p>
                                        </div><!-- End .product-desc-content -->
                                    </div><!-- .End .tab-pane -->
                                {{!-- product review section --}}
                              

                                        {{!-- <div class="social-icons social-icons-sm">
                                            <span class="social-label">Share:</span>
                                            <a href="#" class="social-icon" title="Facebook" target="_blank"><i class="icon-facebook-f"></i></a>
                                            <a href="#" class="social-icon" title="Twitter" target="_blank"><i class="icon-twitter"></i></a>
                                            <a href="#" class="social-icon" title="Instagram" target="_blank"><i class="icon-instagram"></i></a>
                                            <a href="#" class="social-icon" title="Pinterest" target="_blank"><i class="icon-pinterest"></i></a>
                                        </div> --}}
                                    </div><!-- End .product-details-footer -->
                                </div><!-- End .product-details -->
                            </div><!-- End .col-md-6 -->
                        </div><!-- End .row -->
                    </div><!-- End .product-details-top -->
                    {{/each}}
                   

                    <h2 class="title text-center mb-4">You May Also Like</h2><!-- End .title text-center -->

                    <div class="owl-carousel owl-simple carousel-equal-height carousel-with-shadow" data-toggle="owl" 
                        data-owl-options='{
                            "nav": false, 
                            "dots": true,
                            "margin": 20,
                            "loop": false,
                            "responsive": {
                                "0": {
                                    "items":1
                                },
                                "480": {
                                    "items":2
                                },
                                "768": {
                                    "items":3
                                },
                                "992": {
                                    "items":4
                                },
                                "1200": {
                                    "items":4,
                                    "nav": true,
                                    "dots": false
                                }
                            }
                        }'>
                        {{#each relatedProducts}}
                        <div class="product product-7 text-center">
                            <figure class="product-media">
                                <span class="product-label label-new" style="background-color: red !important; border-radius: 2px;">New</span>
                                <a href="/productDetails?productVerientId={{this.productvarient._id}}">
                                    <img src="/images/product/productvarients/{{this.productvarient._id}}_1.png" alt="Product image" class="product-image">
                                </a>

                                <div class="product-action-vertical">
                                    <a href="#" class="btn-product-icon btn-wishlist btn-expandable"><span>add to wishlist</span></a>
                                    <a href="popup/quickView.html" class="btn-product-icon btn-quickview" title="Quick view"><span>Quick view</span></a>
                                    <a href="#" class="btn-product-icon btn-compare" title="Compare"><span>Compare</span></a>
                                </div><!-- End .product-action-vertical -->

                                <div class="product-action">
                                    <a href="#" class="btn-product btn-cart"><span>add to cart</span></a>
                                </div><!-- End .product-action -->
                            </figure><!-- End .product-media -->

                            <div class="product-body">
                                <div class="product-cat">
                                    <a href="#">{{this.category}}</a>
                                </div><!-- End .product-cat -->
                                <h3 class="product-title"><a href="product.html">{{this.productName}}</a></h3><!-- End .product-title -->
                                <div class="product-price">
                                    ₹{{this.productvarient.mrp}}
                                </div><!-- End .product-price -->
                                {{!-- <div class="ratings-container">
                                    <div class="ratings">
                                        <div class="ratings-val" style="width: 20%;"></div><!-- End .ratings-val -->
                                    </div><!-- End .ratings -->
                                    <span class="ratings-text">( 2 Reviews )</span>
                                </div><!-- End .rating-container --> --}}

                                {{!-- <div class="product-nav product-nav-thumbs">
                                    <a href="#" class="active">
                                        <img src="assets/images/products/product-4-thumb.jpg" alt="product desc">
                                    </a>
                                    <a href="#">
                                        <img src="assets/images/products/product-4-2-thumb.jpg" alt="product desc">
                                    </a>

                                    <a href="#">
                                        <img src="assets/images/products/product-4-3-thumb.jpg" alt="product desc">
                                    </a>
                                </div><!-- End .product-nav --> --}}
                            </div><!-- End .product-body -->
                        </div><!-- End .product -->
                        {{/each}}
        
                    </div><!-- End .owl-carousel -->
                </div><!-- End .container -->
            </div><!-- End .page-content -->
        </main><!-- End .main -->
            
    


<script src="//cdn.jsdelivr.net/npm/sweetalert2@11"></script>
{{!-- <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script> --}}
<script>
   
    let selectedQuantity = 0;
    function buyButton(value){
        
        //alert(value)
        selectedQuantity = value

    }
    let deliveryType = 0;
    function delButton(delType){
        
        deliveryType = delType

    }
    
    function buy(productId){
        //alert(productId)
        if(selectedQuantity!=0){

            if(deliveryType!=0){

                $.ajax({

                    url:'/directBuy',
                    method:'post',
                    data:{productId:productId,
                          deliveryType:deliveryType,
                          quantity:selectedQuantity  },
                    success:(response)=>{
                        
                        if(response.buy){

                            window.location.href='/dirCheckout?productId='+productId+'&deliveryType='+deliveryType+'&quantity='+selectedQuantity;

                        }

                    }

                })
                


            }else{
                
                const Toast = Swal.mixin({
                toast: true,
                position: 'top-end',
                showConfirmButton: false,
                timer: 3000,
                timerProgressBar: true,
                didOpen: (toast) => {
                    toast.addEventListener('mouseenter', Swal.stopTimer)
                    toast.addEventListener('mouseleave', Swal.resumeTimer)
                }
                })

                Toast.fire({
                icon: 'error',
                title: 'Please a delivery type'
                })

            }


        }else{
            
            const Toast = Swal.mixin({
                toast: true,
                position: 'top-end',
                showConfirmButton: false,
                timer: 3000,
                timerProgressBar: true,
                didOpen: (toast) => {
                    toast.addEventListener('mouseenter', Swal.stopTimer)
                    toast.addEventListener('mouseleave', Swal.resumeTimer)
                }
                })

                Toast.fire({
                icon: 'error',
                title: 'Please select quantity'
                })
            

        }

    }
            
    function addToCart(productId,mrp){

        //console.log(productId)

        //let currentQuantity = parseInt(document.getElementById(productId).innerHTML);
        mrp = parseInt(mrp);
        
            
            $.ajax({

                url:'/productAddToCart',
                method:'post',
                data:{productId:productId,
                        mrp:mrp},
                success:(response)=>{
                    
                    if(response.valid){

                        let cartCount = $('#cartCount').html();
                        cartCount = parseInt(cartCount)+1;
                        $('#cartCount').html(cartCount)


                        Swal.fire({
                            position: 'middle',
                            icon: 'success',
                            title: 'Product addded to cart',
                            showConfirmButton: false,
                            timer: 2000
                        })

                    }else{
                        
                        Swal.fire({
                            position: 'middle',
                            icon: 'error',
                            title: 'Same product already in your cart',
                            showConfirmButton: false,
                            timer: 2000
                        })
                    }

                }

            })

    }
                         
                    

                

            




    

    function countUpdateD(productId,quantity,count){
       
        quantity = parseInt(quantity);
        count = parseInt(count);
        console.log(quantity)
        let currentQuantity = parseInt(document.getElementById(productId).innerHTML);

        console.log(currentQuantity)

        if(currentQuantity <=1 && count==-1){

            document.getElementById('buttonMinus2').setAttribute('disabled')
             
        } else{

            if(currentQuantity>=quantity && count == 1){
                
                swal("!Sorry there is no stock left")

            }else{

              document.getElementById(productId).innerHTML = currentQuantity + count;
                          
            }

        }

    }
</script>

          
               