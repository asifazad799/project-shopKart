<link rel="stylesheet" href="/stylesheets/userProfile.css">
{{!-- <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"> --}}
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/MaterialDesign-Webfont/3.6.95/css/materialdesignicons.css">
<style>
.swal2-popup {
font-size: 1.6rem;
}
</style>
<div class="page-content page-container mt-5 pt-5" id="page-content">
    <div class="padding d-flex justify-content-center mt-3">
        <div class="row container d-flex justify-content-center">
            <div class="col-xl-9 col-md-12">
                
                
                <div class="card user-card-full">
                    <div class="row m-l-0 m-r-0">
                        <div class="col-sm-4 bg-c-lite-green user-profile d-flex justify-content-center">
                            <div class="card-block text-center text-white">
                                <div style="display: flex; flex-direction: column; ">
                                    {{#if proUpdated}}
                                        <p id="proUpdated"></p>
                                    {{/if}}
                                    {{#if noProPic}}

                                        <img class="ms-auto me-auto mb-3 "  src="../images/abstract-user-flat-1.svg" alt="" style="border-radius: 50%; object-fit: cover;height: 90px; width: 90px; background-color: white;" id="proImageView">

                                    {{/if}}
                                    {{#if ProPic}}

                                    <img class="ms-auto me-auto mb-3 image"  src="http://18.216.136.74/../images/userProfile/{{user1._id}}.jpg" alt="" style="border-radius: 50%; object-fit: cover;height: 90px; width: 90px;" id="proImageView">

                                    {{/if}}
                                    <h6 class="f-w-600 text-white">{{user1.first_name}} <span>{{user1.lastname}}</span> </h6>
                                    <a href="/changePassword" class="text-white">Change Password</a>
                                    <a href="/myOrders" class="text-white">My Orders</a>
                                    <a href="/editUserProfile"> <i class=" mdi mdi-square-edit-outline feather icon-edit m-t-10" style="font-size: 24px; color: white;"></i> </a> 
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-8 p-3">
                            <div class="card-block">
                                <h6 class="m-b-20 p-b-5 b-b-default f-w-600">Profile</h6>
                                <div class="row">
                                    <div class="col-sm-6">
                                        <p class="m-b-10 f-w-600">Email</p>
                                        <h6 class="text-muted f-w-400">{{user1.email}}</h6>
                                    </div>
                                    <div class="col-sm-6">
                                        <p class="m-b-10 f-w-600">Phone</p>
                                        <h6 class="text-muted f-w-400">{{user1.mobile}}</h6>
                                    </div>
                                </div>
                               
                                <h6 class="m-b-20 m-t-40 p-b-5 b-b-default f-w-600">Saved Addresses</h6>
                                {{#if addressAdded}}
                                <input type="text" id="Added" hidden value="{{addressAdded}}">
                                {{/if}}
                                {{#if adressUpdated}}
                                <input type="text" id="updated" hidden >
                                {{/if}}
                                {{#if passwordReseted}}
                                <input type="text" id="passwordReseted" hidden >
                                {{/if}}
                                <div class="row">
                                    
                                    {{#each address1.address}}
                                    <div class="col-sm-6 p-3">
                                        <div style="background-color: #f7f7f7; border-radius: 2px; height: 100%; padding: 18px; box-shadow:  0px 0px 20px 2px  rgb(187, 187, 187)">
                                            <div style="">
                                                <div style="height: 100%;">

                                                    <h6 class="text-dark f-w-400">Address</h6>
                                                    <p class=""><span style="font-weight: 400; color: black;">House Number:</span>{{this.houseNumber}}</p>
                                                    <p class=""><span style="font-weight: 400; color: black;">locality:</span>{{this.locality}}</p>
                                                    <p class=""><span style="font-weight: 400; color: black;">district:</span>{{this.district}}</p>
                                                    <p class=""><span style="font-weight: 400; color: black;">state:</span>{{this.state}}</p>
                                                    <p class=""><span style="font-weight: 400; color: black;">pincode:</span>{{this.pincode}}</p>

                                                </div>
                                            </div>
                                            <div class="pt-3 d-flex justify-content-around" >
                                                <div style="display: flex; position: absolute; bottom: 0; margin-bottom: 19px;">
                                                    

                                                    <div class="p-1 text-center" style="background-color: blue;border-radius: 2px; width: 40px; padding-left: 7px !important; cursor: pointer;">

                                                        <a href="/editAddress?addressId={{this.addressId}}" class="text-white"><i class="far fa-edit"></i></a>
                                                        {{!-- onclick="editAddress('{{this.addressId}}') --}}
                                                    </div>
                                                    <div class="p-3">

                                                    </div>
                                                    <div class="p-1 text-center" style="background-color: red;border-radius: 2px; width: 40px; cursor: pointer;">

                                                        <a onclick="deleteAddress('{{this.addressId}}')" class="text-white"><i class="far fa-trash-alt"></i></a>
                                                        
                                                    
                                                    </div>


                                                </div>

                                            </div>
                                        </div>
                                        
                                    </div>
                                    
                                    
                                   {{/each}}
                                    
                                    
                                    
                                </div>
                                <div class="cl-lg-3 text-center mt-2 mb-0">
                                    <a href="/addNewAddress" class="btn btn-primary loginFormButton">Add new address</a>
                                </div>
                                {{!-- <ul class="social-link list-unstyled m-t-40 m-b-10">
                                    <li><a href="#!" data-toggle="tooltip" data-placement="bottom" title="" data-original-title="facebook" data-abc="true"><i class="mdi mdi-facebook feather icon-facebook facebook" aria-hidden="true"></i></a></li>
                                    <li><a href="#!" data-toggle="tooltip" data-placement="bottom" title="" data-original-title="twitter" data-abc="true"><i class="mdi mdi-twitter feather icon-twitter twitter" aria-hidden="true"></i></a></li>
                                    <li><a href="#!" data-toggle="tooltip" data-placement="bottom" title="" data-original-title="instagram" data-abc="true"><i class="mdi mdi-instagram feather icon-instagram instagram" aria-hidden="true"></i></a></li>
                                </ul> --}}
                            </div>
                        </div>
                    </div>
                </div>
                
                
            </div>
        </div>
    </div>
</div>

<script src="//cdn.jsdelivr.net/npm/sweetalert2@11"></script>

<script>
    
    if(document.getElementById('proUpdated')){
        
        const Toast = Swal.mixin({
            toast: true,
            position: 'top',
            showConfirmButton: false,
            timer: 3000,
            timerProgressBar: true,
            didOpen: (toast) => {
                toast.addEventListener('mouseenter', Swal.stopTimer)
                toast.addEventListener('mouseleave', Swal.resumeTimer)
            }
            })

            Toast.fire({
            icon: 'success',
            title: 'profile updated successfully'
            })


    }

    if(document.getElementById('Added')){

        Swal.fire({
        position: 'middle',
        icon: 'success',
        title: 'New Address Added',
        showConfirmButton: false,
        timer: 1500
    })
    }
    if(document.getElementById('updated')){

            Swal.fire({
            position: 'middle',
            icon: 'success',
            title: 'Your Address Updated',
            showConfirmButton: false,
            timer: 1500
        })
    }

    if(document.getElementById('passwordReseted')){

            Swal.fire({
            position: 'middle',
            icon: 'success',
            title: 'Your Password changed',
            showConfirmButton: false,
            timer: 1500
        })
    }   

         

         




    function deleteAddress(addressId){

        Swal.fire({
            title: 'Are you sure?',
            text: "You won't be able to revert this!",
            icon: 'warning',
            showCancelButton: true,
            confirmButtonColor: '#3085d6',
            cancelButtonColor: '#d33',
            confirmButtonText: 'Yes, delete it!'
        }).then((result) => {
            if (result.isConfirmed) {

                $.ajax({
                    url:"/deleteAddress",
                    method:'post',
                    data:{address:addressId},
                    success:(result)=>{
                        if(result){

                            Swal.fire(
                                'Deleted!',
                                'Your file has been deleted.',
                                'success'
                            ).then((result)=>{
                                window.location.reload()
                                })
                            setTimeout(window.location.reload.bind(window.location),3050);

                        }
                    }
                })

                
            }
        })

    }

</script>